Tools for Kubernetes
1.  Best ways for Canary Deployments --> Istio (Open Source) and AWS AppMesh (AWS version of Istio)

eksctl create cluster --name=eksdemo1 \
                      --region=ap-southeast-1 \
                      --zones=ap-southeast-1a,ap-southeast-1b \
                      --without-nodegroup 

eksctl create cluster --name=eksdemo1 --region=ap-southeast-1 --zones=ap-southeast-1a,ap-southeast-1b --without-nodegroup

# Create Public Node Group   
eksctl create nodegroup --cluster=eksdemo1 \
                       --region=ap-southeast-1 \
                       --name=eksdemo1-ng-public1 \
                       --node-type=t3.small \
                       --nodes=1 \
                       --nodes-min=1 \
                       --nodes-max=2 \
                       --node-volume-size=20 \
                       --ssh-access \
                       --ssh-public-key=kube-demo \
                       --managed \
                       --asg-access \
                       --external-dns-access \
                       --full-ecr-access \
                       --appmesh-access \
                       --alb-ingress-access 

eksctl create nodegroup --cluster=eksdemo1 --region=ap-southeast-1 --name=eksdemo1-ng-public1 --node-type=t3.small --nodes=2 --nodes-min=2 --nodes-max=3 --node-volume-size=20 --ssh-access --ssh-public-key=kube-demo --managed --asg-access --external-dns-access --full-ecr-access --appmesh-access --alb-ingress-access


eksctl delete nodegroup --name=eksdemo1-ng-public1 --cluster=eksdemo1

eksctl delete cluster --name=eksdemo1

to remove ssh open key permission

icacls .\kube-demo.pem /inheritance:r
icacls.exe .\kube-demo.pem /GRANT:R "$($env:USERNAME):(R)"


-----------------------------

1.  Create cluster and Nodegroup
2.  Amazon_EBS_CSI_Driver --> Add policy to newly created roles in IAM
3. Install CSI driver using command --> kubectl apply -k "github.com/kubernetes-sigs/aws-ebs-csi-driver/deploy/kubernetes/overlays/stable/?ref=master"
    # Verify ebs-csi pods running
    kubectl get pods -n kube-system


while deleting cluster
k get pdb -A
kubectl delete pdb ebs-csi-controller -n kube-system
